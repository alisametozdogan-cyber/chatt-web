<!DOCTYPE html>
<html>
<head>
  <title>Chatt Web</title>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js"></script>
</head>
<body style="font-family: Arial; background:#111; color:white; text-align:center;">

<h2>ðŸ”¥ Chatt Web</h2>

<input id="username" placeholder="KullanÄ±cÄ± AdÄ±">
<br><br>
<input id="message" placeholder="Mesaj yaz...">
<button onclick="sendMessage()">GÃ¶nder</button>

<div id="chat" style="margin-top:20px;"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getDatabase, ref, push, onChildAdded, remove } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBhZF2igk9MZF-UEVYQEJl9N6IhMAeRsLU",
    authDomain: "chatt-5c23d.firebaseapp.com",
    databaseURL: "https://chatt-5c23d-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "chatt-5c23d",
    storageBucket: "chatt-5c23d.firebasestorage.app",
    messagingSenderId: "307426902187",
    appId: "1:307426902187:web:6bb314fe10261a1733b7ee"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Mesaj gÃ¶nderme
  window.sendMessage = function() {
    const username = document.getElementById("username").value;
    const message = document.getElementById("message").value;
    if(username && message){
      push(ref(db, "messages"), { user: username, text: message });
      document.getElementById("message").value = "";
    }
  }

  // Mesaj silme
  function deleteMessage(mesajId){
    remove(ref(db, "messages/" + mesajId))
      .then(() => console.log("Mesaj silindi"))
      .catch(err => console.error("Hata: ", err));
  }

  // MesajlarÄ± ekrana yazdÄ±r ve sil butonu ekle
  onChildAdded(ref(db, "messages"), (data) => {
    const msg = data.val();
    const id = data.key;
    const chatDiv = document.getElementById("chat");
    const p = document.createElement("p");
    p.innerHTML = `<b>${msg.user}:</b> ${msg.text} <button onclick="deleteMessage('${id}')">Sil</button>`;
    chatDiv.appendChild(p);
  });

</script>

</body>
</html>
